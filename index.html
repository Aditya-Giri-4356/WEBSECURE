<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ùïéùîºùîπùïäùîº‚ÑÇùïå‚Ñùùîº ‚Äì Continuous Web Assurance Platform</title>
    <meta name="description" content="ùïéùîºùîπùïäùîº‚ÑÇùïå‚Ñùùîº helps cybersecurity teams validate web applications with continuous scans across SQLi, XSS, auth, headers, TLS, directories, and cookies.">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta id="themeColorMeta" name="theme-color" content="#E5E9F0">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîí</text></svg>">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        :root {
            --nord0: #2E3440;
            --nord1: #3B4252;
            --nord2: #434C5E;
            --nord3: #4C566A;
            --nord4: #D8DEE9;
            --nord5: #E5E9F0;
            --nord6: #ECEFF4;
            --nord7: #8FBCBB;
            --nord8: #88C0D0;
            --nord9: #81A1C1;
            --nord10: #5E81AC;
            --nord11: #BF616A;
            --nord12: #D08770;
            --nord13: #EBCB8B;
            --nord14: #A3BE8C;
            --nord15: #B48EAD;

            --color-bg: var(--nord6);
            --color-surface: #ffffff;
            --color-surface-alt: var(--nord5);
            --color-text: var(--nord0);
            --color-text-muted: var(--nord3);
            --color-border: var(--nord4);
            --color-primary: var(--nord10);
            --color-primary-accent: var(--nord8);
            --color-primary-hover: #4C6E91;
            --color-success: var(--nord14);
            --color-warning: var(--nord13);
            --color-danger: var(--nord11);
            --color-danger-hover: #a04e56;
            --color-info: var(--nord9);
            --color-footer: var(--nord2);
            --color-glass-bg: rgba(255, 255, 255, 0.35);
            --color-muted-overlay: rgba(46, 52, 64, 0.08);
        }

        [data-theme="dark"] {
            --color-bg: var(--nord0);
            --color-surface: var(--nord1);
            --color-surface-alt: var(--nord2);
            --color-text: var(--nord6);
            --color-text-muted: var(--nord4);
            --color-border: var(--nord3);
            --color-primary: var(--nord8);
            --color-primary-accent: var(--nord7);
            --color-primary-hover: #6A99AA;
            --color-success: var(--nord14);
            --color-warning: var(--nord13);
            --color-danger: var(--nord11);
            --color-danger-hover: #d9777f;
            --color-info: var(--nord8);
            --color-footer: #1F242E;
            --color-glass-bg: rgba(255, 255, 255, 0.08);
            --color-muted-overlay: rgba(236, 239, 244, 0.16);
        }

        body {
            background-color: var(--color-bg);
            color: var(--color-text);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .gradient-bg {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-accent) 100%);
        }

        .glass-effect {
            background: var(--color-glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card-surface {
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
        }

        .section-heading {
            color: var(--color-text);
        }

        .scan-progress {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .vulnerability-card {
            transition: all 0.3s ease;
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            overflow-wrap: anywhere;
        }

        .vulnerability-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .vulnerability-card[data-severity="critical"],
        .vulnerability-card[data-severity="high"] {
            border-color: var(--color-danger);
            background: rgba(191, 97, 106, 0.12);
        }

        .vulnerability-card[data-severity="medium"] {
            border-color: var(--color-warning);
            background: rgba(235, 203, 139, 0.12);
        }

        .vulnerability-card[data-severity="low"] {
            border-color: var(--color-info);
            background: rgba(129, 161, 193, 0.12);
        }

        .severity-pill {
            display: inline-flex;
            align-items: center;
            padding: 0.15rem 0.5rem;
            border-radius: 999px;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            background-color: var(--color-muted-overlay);
        }

        .vulnerability-card[data-severity="critical"] .severity-pill,
        .vulnerability-card[data-severity="high"] .severity-pill {
            background-color: var(--color-danger);
            color: #fff;
        }

        .vulnerability-card[data-severity="medium"] .severity-pill {
            background-color: var(--color-warning);
            color: var(--color-text);
        }

        .vulnerability-card[data-severity="low"] .severity-pill {
            background-color: var(--color-info);
            color: #fff;
        }

        .recommendation-box {
            background-color: var(--color-glass-bg);
            border: 1px solid var(--color-border);
            overflow-wrap: anywhere;
        }

        .code-chip {
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            background-color: var(--color-muted-overlay);
            color: var(--color-text);
            display: inline-block;
            width: 100%;
            white-space: pre-wrap;
            word-break: break-word;
            overflow-x: auto;
        }

        .card-surface,
        .safety-banner {
            overflow-wrap: anywhere;
        }

        .safety-banner {
            background: var(--color-surface-alt);
            border-bottom: 1px solid var(--color-border);
            color: var(--color-text);
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
        }

        .safety-banner .blink-text {
            font-weight: 700;
            letter-spacing: 0.08em;
            animation: blink 1.2s infinite;
            color: var(--color-danger);
        }

        .safety-banner .banner-message {
            font-size: 0.95rem;
        }

        .banner-info {
            background: rgba(129, 161, 193, 0.15);
        }

        .banner-success {
            background: rgba(163, 190, 140, 0.2);
        }

        .banner-error {
            background: rgba(191, 97, 106, 0.2);
        }

        .btn-primary {
            background-color: var(--color-primary);
            color: #fff;
        }

        .btn-primary:hover {
            background-color: var(--color-primary-hover);
        }

        .btn-secondary {
            background-color: var(--color-muted-overlay);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            filter: brightness(0.95);
        }

        .btn-danger {
            background-color: var(--color-danger);
            color: #fff;
        }

        .btn-danger:hover {
            background-color: var(--color-danger-hover);
        }

        .btn-success {
            background-color: var(--color-success);
            color: var(--color-text);
        }

        .btn-success:hover {
            filter: brightness(0.95);
        }

        .badge {
            background-color: var(--color-muted-overlay);
            color: var(--color-text);
        }

        .footer-bg {
            background-color: var(--color-footer);
        }

        .bg-gray-50 {
            background-color: var(--color-bg) !important;
        }

        .bg-white {
            background-color: var(--color-surface) !important;
        }

        .bg-gray-100 {
            background-color: var(--color-surface-alt) !important;
        }

        .bg-gray-200 {
            background-color: rgba(236, 239, 244, 0.5) !important;
        }

        .bg-gray-800 {
            background-color: var(--color-footer) !important;
        }

        .bg-white\/20,
        .bg-white\/30 {
            background-color: var(--color-glass-bg) !important;
        }

        .bg-black\/10 {
            background-color: var(--color-muted-overlay) !important;
        }

        .text-gray-700,
        .text-gray-600 {
            color: var(--color-text-muted) !important;
        }

        .text-gray-900,
        .text-gray-800 {
            color: var(--color-text) !important;
        }

        .text-gray-500 {
            color: var(--color-text-muted);
        }

        .text-blue-600,
        .text-blue-500 {
            color: var(--color-info) !important;
        }

        .text-yellow-500,
        .text-yellow-600 {
            color: var(--color-warning) !important;
        }

        .text-red-600,
        .text-red-500 {
            color: var(--color-danger) !important;
        }

        .border-gray-300 {
            border-color: var(--color-border) !important;
        }

        .bg-blue-600 {
            background-color: var(--color-primary) !important;
        }

        .hover\:bg-blue-700:hover {
            background-color: var(--color-primary-hover) !important;
        }

        .bg-red-600 {
            background-color: var(--color-danger) !important;
        }

        .hover\:bg-red-700:hover {
            background-color: var(--color-danger-hover) !important;
        }

        .bg-green-600 {
            background-color: var(--color-success) !important;
        }

        .hover\:bg-green-700:hover {
            filter: brightness(0.9);
        }

        .focus\:ring-blue-500:focus {
            --tw-ring-color: var(--color-primary);
        }

        input,
        select,
        textarea {
            background-color: var(--color-surface);
            color: var(--color-text);
        }

        .status-muted {
            color: var(--color-text-muted);
        }

        .brand-heading,
        .section-heading,
        .card-surface h3,
        .vulnerability-card h4,
        #aiAssistantSection h3 {
            font-family: 'Georgia', 'Times New Roman', serif;
            color: #1f2933;
        }

        .brand-heading {
            color: #111827;
        }
    </style>
</head>
<body class="min-h-screen transition-colors duration-300">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                <div class="flex items-center space-x-3">
                    <i data-lucide="shield" class="w-8 h-8"></i>
                    <div>
                        <h1 class="text-3xl font-bold brand-heading tracking-wide">ùïéùîºùîπùïäùîº‚ÑÇùïå‚Ñùùîº</h1>
                        <p class="text-sm text-white/90">Continuous web assurance for defenders who need proof, not promises.</p>
                    </div>
                </div>
                <div class="flex items-center flex-wrap gap-3 md:justify-end">
                    <button id="installBtn" class="glass-effect px-4 py-2 rounded-lg hover:bg-white/20 transition w-full sm:w-auto text-center">
                        <i data-lucide="download" class="w-4 h-4 inline mr-2"></i>
                        Install App
                    </button>
                    <button id="themeToggle" class="p-2 rounded-lg hover:bg-white/20 transition w-full sm:w-auto flex items-center justify-center" aria-label="Toggle theme">
                        <i id="themeIcon" data-lucide="moon" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <section id="safetyBanner" class="safety-banner banner-info">
        <span class="blink-text">USE THIS TOOL SAFELY</span>
        <span id="bannerMessage" class="banner-message">Run scans only on assets you own or have permission to test.</span>
    </section>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Scanner Input Section -->
        <section class="card-surface rounded-xl shadow-lg p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4 flex items-center section-heading">
                <i data-lucide="target" class="w-5 h-5 mr-2 text-blue-600"></i>
                <span style="color: var(--nord13);">Target Configuration</span>
            </h2>
            
            <div class="space-y-4">
                <div>
                    <label for="targetUrl" class="block text-sm font-medium text-gray-700 mb-2">
                        Target URL
                    </label>
                    <div class="flex flex-col gap-3 sm:flex-row sm:gap-2">
                        <input 
                            type="url" 
                            id="targetUrl" 
                            placeholder="https://example.com" 
                            class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-0"
                        >
                        <button id="validateUrl" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition w-full sm:w-auto">
                            <i data-lucide="check" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Scan Types
                    </label>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-3">
                        <label class="flex items-start space-x-3 cursor-pointer p-3 rounded-lg border border-gray-200">
                            <input type="checkbox" id="sqlInjection" checked class="mt-1 w-4 h-4 text-blue-600 rounded">
                            <div>
                                <span class="text-sm font-medium">SQL Injection</span>
                                <p class="text-xs text-gray-500">Detect unsanitized database queries.</p>
                            </div>
                        </label>
                        <label class="flex items-start space-x-3 cursor-pointer p-3 rounded-lg border border-gray-200">
                            <input type="checkbox" id="xss" checked class="mt-1 w-4 h-4 text-blue-600 rounded">
                            <div>
                                <span class="text-sm font-medium">XSS Vulnerabilities</span>
                                <p class="text-xs text-gray-500">Test for reflected/DOM-based payloads.</p>
                            </div>
                        </label>
                        <label class="flex items-start space-x-3 cursor-pointer p-3 rounded-lg border border-gray-200">
                            <input type="checkbox" id="auth" checked class="mt-1 w-4 h-4 text-blue-600 rounded">
                            <div>
                                <span class="text-sm font-medium">Authentication Issues</span>
                                <p class="text-xs text-gray-500">Weak creds, password policy, brute force.</p>
                            </div>
                        </label>
                        <label class="flex items-start space-x-3 cursor-pointer p-3 rounded-lg border border-gray-200">
                            <input type="checkbox" id="securityHeaders" checked class="mt-1 w-4 h-4 text-blue-600 rounded">
                            <div>
                                <span class="text-sm font-medium">Security Headers</span>
                                <p class="text-xs text-gray-500">HSTS, CSP, X-Frame-Options, Referrer Policy.</p>
                            </div>
                        </label>
                        <label class="flex items-start space-x-3 cursor-pointer p-3 rounded-lg border border-gray-200">
                            <input type="checkbox" id="tls" checked class="mt-1 w-4 h-4 text-blue-600 rounded">
                            <div>
                                <span class="text-sm font-medium">TLS Configuration</span>
                                <p class="text-xs text-gray-500">Certificate expiry, protocol downgrades.</p>
                            </div>
                        </label>
                        <label class="flex items-start space-x-3 cursor-pointer p-3 rounded-lg border border-gray-200">
                            <input type="checkbox" id="dirListing" checked class="mt-1 w-4 h-4 text-blue-600 rounded">
                            <div>
                                <span class="text-sm font-medium">Directory Listing</span>
                                <p class="text-xs text-gray-500">Detect exposed backups/logs.</p>
                            </div>
                        </label>
                        <label class="flex items-start space-x-3 cursor-pointer p-3 rounded-lg border border-gray-200">
                            <input type="checkbox" id="weakCookies" checked class="mt-1 w-4 h-4 text-blue-600 rounded">
                            <div>
                                <span class="text-sm font-medium">Weak Cookies</span>
                                <p class="text-xs text-gray-500">Missing HttpOnly/Secure/SameSite flags.</p>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="flex flex-col gap-3 sm:flex-row">
                    <button id="startScan" class="flex-1 btn-primary px-6 py-3 rounded-lg hover:bg-blue-700 transition font-medium">
                        <i data-lucide="play" class="w-4 h-4 inline mr-2"></i>
                        Start Security Scan
                    </button>
                    <button id="stopScan" class="px-6 py-3 btn-danger rounded-lg hover:bg-red-700 transition font-medium disabled:opacity-50 w-full sm:w-auto" disabled>
                        <i data-lucide="square" class="w-4 h-4 inline mr-2"></i>
                        Stop
                    </button>
                </div>
            </div>
        </section>

        <!-- Progress Section -->
        <section id="progressSection" class="card-surface rounded-xl shadow-lg p-6 mb-8 hidden">
            <h3 class="text-lg font-semibold mb-4">Scan Progress</h3>
            <div class="space-y-3">
                <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
                    <span id="scanStatus" class="text-sm status-muted">Initializing...</span>
                    <span id="scanProgress" class="text-sm font-medium">0%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progressBar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div id="currentTask" class="text-sm status-muted scan-progress"></div>
            </div>
        </section>

        <!-- Results Section -->
        <section id="resultsSection" class="hidden">
            <!-- Summary Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                <div class="card-surface rounded-lg shadow p-4 vulnerability-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Total Issues</p>
                            <p id="totalIssues" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                        <i data-lucide="alert-triangle" class="w-8 h-8 text-yellow-500"></i>
                    </div>
                </div>
                <div class="card-surface rounded-lg shadow p-4 vulnerability-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Critical</p>
                            <p id="criticalIssues" class="text-2xl font-bold text-red-600">0</p>
                        </div>
                        <i data-lucide="alert-circle" class="w-8 h-8 text-red-500"></i>
                    </div>
                </div>
                <div class="card-surface rounded-lg shadow p-4 vulnerability-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Medium</p>
                            <p id="mediumIssues" class="text-2xl font-bold text-yellow-600">0</p>
                        </div>
                        <i data-lucide="alert-circle" class="w-8 h-8 text-yellow-500"></i>
                    </div>
                </div>
                <div class="card-surface rounded-lg shadow p-4 vulnerability-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Low</p>
                            <p id="lowIssues" class="text-2xl font-bold text-blue-600">0</p>
                        </div>
                        <i data-lucide="info" class="w-8 h-8 text-blue-500"></i>
                    </div>
                </div>
            </div>

            <!-- Detailed Results -->
            <div class="card-surface rounded-xl shadow-lg p-6 mb-8">
                <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between mb-4">
                    <h3 class="text-lg font-semibold">Detailed Findings</h3>
                    <div class="flex flex-wrap gap-2 w-full md:w-auto md:justify-end">
                        <button id="exportJson" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-sm flex-1 md:flex-none">
                            <i data-lucide="download" class="w-4 h-4 inline mr-1"></i>
                            Export JSON
                        </button>
                        <button id="exportPdf" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm flex-1 md:flex-none">
                            <i data-lucide="file-text" class="w-4 h-4 inline mr-1"></i>
                            Export PDF
                        </button>
                    </div>
                </div>
                <div id="findingsList" class="space-y-3">
                    <!-- Findings will be populated here -->
                </div>
            </div>

            <!-- AI Assistant Quick Fixes -->
            <div id="aiAssistantSection" class="card-surface rounded-xl shadow-lg p-6 hidden">
                <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between mb-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-full bg-blue-600/10 flex items-center justify-center text-blue-600">
                            <i data-lucide="sparkles" class="w-5 h-5"></i>
                        </div>
                        <div>
                            <p class="text-xs tracking-wider uppercase text-gray-600">AI Assistant</p>
                            <h3 class="text-lg font-semibold">Quick Fix Suggestions</h3>
                        </div>
                    </div>
                    <span class="text-xs status-muted">Auto-generated guidance</span>
                </div>
                <p id="aiAssistantSummary" class="text-sm text-gray-700 mb-4">
                    AI Assistant is ready to suggest prioritized fixes once a scan completes.
                </p>
                <ul id="aiAssistantQuickFixes" class="space-y-3">
                    <li class="rounded-lg border border-gray-200 bg-white/60 p-4">
                        <p class="text-sm status-muted">Run a scan to receive contextual remediation steps.</p>
                    </li>
                </ul>
            </div>
        </section>
    </main>

    <!-- Scripts -->
    <script src="scanner.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // PWA Installation
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'block';
        });
        
        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                if (outcome === 'accepted') {
                    installBtn.style.display = 'none';
                }
            }
        });

        // Theme management
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const themeColorMeta = document.getElementById('themeColorMeta');

        const THEME_KEY = 'wss-theme-preference';

        const applyTheme = (theme) => {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem(THEME_KEY, theme);
            const iconName = theme === 'dark' ? 'sun' : 'moon';
            themeIcon.setAttribute('data-lucide', iconName);
            themeColorMeta.setAttribute('content', theme === 'dark' ? '#2E3440' : '#E5E9F0');
            lucide.createIcons();
        };

        const getPreferredTheme = () => {
            const stored = localStorage.getItem(THEME_KEY);
            if (stored) return stored;
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        };

        applyTheme(getPreferredTheme());

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const nextTheme = currentTheme === 'dark' ? 'light' : 'dark';
            applyTheme(nextTheme);
        });
    </script>
</body>
</html>
